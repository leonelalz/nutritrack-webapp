import{a as nt}from"./chunk-Y4ECP4HO.js";import{a as X,b as Y,c as Z,d as tt,e as et}from"./chunk-7Y6DIVO4.js";import{a as U,c as $,e as q,f as H,g as J,j as K,o as Q}from"./chunk-AAWOA4Z3.js";import{k as T,l as R,u as D,v as z}from"./chunk-4WQ3J2NC.js";import{a as G}from"./chunk-SMVVNKRT.js";import{c as V,g as j,j as B,v as W}from"./chunk-2VZLF2MU.js";import"./chunk-6LZ2YNEV.js";import{f as N,g as F}from"./chunk-7Q5XKRGT.js";import{$ as u,Ka as l,Kb as x,Mb as o,Nb as O,Ob as h,Pa as C,Qb as S,Rb as E,Sb as y,Va as k,Vb as w,aa as f,ib as _,jb as b,ka as d,kb as A,lb as P,mb as v,nb as g,ob as a,pb as i,qb as L,ub as M,wb as p,xc as I,yb as m}from"./chunk-FVUT7SF7.js";import"./chunk-2VMXMS7J.js";var ot=r=>["/admin/planes",r],rt=r=>["/admin/planes",r,"editar"],at=(r,e)=>e.id;function lt(r,e){r&1&&(a(0,"div",12)(1,"mat-icon"),o(2,"hourglass_empty"),i(),a(3,"p"),o(4,"Cargando planes..."),i()())}function st(r,e){r&1&&(a(0,"mat-card")(1,"mat-card-content")(2,"div",13)(3,"mat-icon",14),o(4,"restaurant_menu"),i(),a(5,"h3"),o(6,"No hay planes registrados"),i(),a(7,"p"),o(8,"Comienza creando tu primer plan nutricional para el sistema"),i(),a(9,"button",5)(10,"mat-icon"),o(11,"add"),i(),o(12," Crear Primer Plan "),i()()()())}function ct(r,e){if(r&1&&(a(0,"span",26),o(1),i()),r&2){let t=e.$implicit;l(),O(t.nombre)}}function mt(r,e){if(r&1){let t=M();a(0,"tr",22)(1,"td",23)(2,"div",24),o(3),i()(),a(4,"td")(5,"span",25),o(6),i()(),a(7,"td"),P(8,ct,2,1,"span",26,at),i(),a(10,"td")(11,"span",27),o(12),i()(),a(13,"td",28),o(14),i(),a(15,"td",29)(16,"button",30)(17,"mat-icon"),o(18,"visibility"),i()(),a(19,"button",31)(20,"mat-icon"),o(21,"edit"),i()(),a(22,"button",32),p("click",function(){let s=u(t).$implicit,c=m(2);return f(c.confirmarEliminar(s))}),a(23,"mat-icon"),o(24,"delete"),i()()()()}if(r&2){let t=e.$implicit,n=m(2);x("inactive",!t.activo),l(3),O(t.nombre),l(3),h("",t.duracionDias," Semanas"),l(2),v(t.etiquetas),l(3),x("active",t.activo)("inactive",!t.activo),l(),h(" ",t.activo?"Activo":"Inactivo"," "),l(2),h(" ",n.formatearFecha(t.createdAt)," "),l(2),g("routerLink",w(13,ot,t.id)),l(3),g("routerLink",w(15,rt,t.id)),l(3),g("disabled",t.numeroUsuariosActivos&&t.numeroUsuariosActivos>0)}}function dt(r,e){if(r&1&&(a(0,"span",33),o(1),i()),r&2){let t=m().$implicit;l(),O(t)}}function pt(r,e){if(r&1){let t=M();a(0,"button",35),p("click",function(){u(t);let s=m().$implicit,c=m(2);return f(c.irAPagina(c.Number(s)-1))}),o(1),i()}if(r&2){let t=m().$implicit,n=m(2);x("active",t===n.paginaActual()+1),l(),h(" ",t," ")}}function gt(r,e){if(r&1&&_(0,dt,2,1,"span",33)(1,pt,2,3,"button",34),r&2){let t=e.$implicit;b(t==="..."?0:1)}}function ut(r,e){if(r&1){let t=M();a(0,"div",15)(1,"table",16)(2,"thead")(3,"tr")(4,"th"),o(5,"Nombre del Plan"),i(),a(6,"th"),o(7,"Duraci\xF3n"),i(),a(8,"th"),o(9,"Objetivo"),i(),a(10,"th"),o(11,"Estado"),i(),a(12,"th"),o(13,"Fecha de Creaci\xF3n"),i(),L(14,"th",17),i()(),a(15,"tbody"),P(16,mt,25,17,"tr",18,at),i()()(),a(18,"div",19)(19,"button",20),p("click",function(){u(t);let s=m();return f(s.paginaAnterior())}),a(20,"mat-icon"),o(21,"chevron_left"),i(),o(22," Anterior "),i(),a(23,"div",21),P(24,gt,2,1,null,null,A),i(),a(26,"button",20),p("click",function(){u(t);let s=m();return f(s.paginaSiguiente())}),o(27," Siguiente "),a(28,"mat-icon"),o(29,"chevron_right"),i()()()}if(r&2){let t=m();l(16),v(t.planesFiltrados()),l(3),g("disabled",t.paginaActual()===0),l(5),v(t.paginasVisibles()),l(2),g("disabled",t.paginaActual()>=t.totalPaginas()-1)}}var it=class r{constructor(e,t,n){this.planService=e;this.notificationService=t;this.router=n}loading=d(!1);mostrarInactivos=d(!1);filtroNombre=d("");planesFiltrados=d([]);filtrosActivos=d([]);paginaActual=d(0);totalPaginas=d(1);tama\u00F1oPagina=20;Number=Number;ngOnInit(){this.cargarPlanes()}toggleFiltros(){this.mostrarInactivos.update(e=>!e),this.mostrarInactivos()?this.filtrosActivos.set(["Mostrar inactivos"]):this.filtrosActivos.set([]),this.cargarPlanes()}removerFiltro(e){this.filtrosActivos.update(t=>t.filter(n=>n!==e)),e==="Mostrar inactivos"&&(this.mostrarInactivos.set(!1),this.cargarPlanes())}paginaAnterior(){this.paginaActual()>0&&(this.paginaActual.update(e=>e-1),this.cargarPlanes())}paginaSiguiente(){this.paginaActual()<this.totalPaginas()-1&&(this.paginaActual.update(e=>e+1),this.cargarPlanes())}irAPagina(e){this.paginaActual.set(e),this.cargarPlanes()}paginasVisibles(){let e=this.totalPaginas(),t=this.paginaActual()+1,n=[];if(e<=7)for(let s=1;s<=e;s++)n.push(s);else{n.push(1),t>3&&n.push("...");for(let s=Math.max(2,t-1);s<=Math.min(e-1,t+1);s++)n.push(s);t<e-2&&n.push("..."),e>1&&n.push(e)}return n}formatearFecha(e){return e?new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}cargarPlanes(){this.loading.set(!0),(this.mostrarInactivos()?this.planService.obtenerPlanes(this.paginaActual(),this.tama\u00F1oPagina):this.planService.obtenerPlanesActivos(this.paginaActual(),this.tama\u00F1oPagina)).subscribe({next:t=>{if(this.loading.set(!1),t.success&&t.data){this.planesFiltrados.set(this.planService.planes());let n=this.planService.totalElements();this.totalPaginas.set(Math.ceil(n/this.tama\u00F1oPagina))}},error:()=>{this.loading.set(!1),this.notificationService.showError("Error al cargar planes")}})}filtrarPlanes(){let e=this.filtroNombre().trim();if(!e){this.paginaActual.set(0),this.cargarPlanes();return}this.loading.set(!0),this.planService.buscarPlanes(e,this.paginaActual(),this.tama\u00F1oPagina).subscribe({next:t=>{if(this.loading.set(!1),t.success&&t.data){this.planesFiltrados.set(this.planService.planes());let n=this.planService.totalElements();this.totalPaginas.set(Math.ceil(n/this.tama\u00F1oPagina))}},error:()=>{this.loading.set(!1),this.notificationService.showError("Error al buscar planes")}})}confirmarEliminar(e){confirm(`\xBFEst\xE1s seguro de eliminar el plan "${e.nombre}"?

Esta acci\xF3n no se puede deshacer.`)&&this.planService.eliminarPlan(e.id).subscribe({next:n=>{n.success&&(this.notificationService.showSuccess("Plan eliminado exitosamente"),this.cargarPlanes())},error:n=>{n.status===409?this.notificationService.showError(n.error.message||"El plan tiene usuarios activos"):this.notificationService.showError("Error al eliminar plan")}})}formatearObjetivo(e){return e?{PERDER_PESO:"P\xE9rdida de Peso",GANAR_MASA_MUSCULAR:"Ganancia Muscular",MANTENER_FORMA:"Mantenimiento",REHABILITACION:"Rehabilitaci\xF3n",CONTROLAR_ESTRES:"Control de Estr\xE9s",SALUD_GENERAL:"Salud General"}[e]||e:"Sin objetivo"}static \u0275fac=function(t){return new(t||r)(C(nt),C(G),C(N))};static \u0275cmp=k({type:r,selectors:[["app-lista-planes"]],decls:27,vars:5,consts:[[1,"page-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],["mat-raised-button","","color","primary","routerLink","/admin/planes/crear"],[1,"filters-card"],[1,"filters"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Buscar por nombre...",3,"ngModelChange","ngModel"],["matPrefix",""],[3,"ngModelChange","ngModel"],[1,"loading-state"],[1,"empty-state"],[1,"empty-icon"],[1,"table-container"],[1,"plans-table"],[1,"actions-column"],[1,"plan-row",3,"inactive"],[1,"pagination"],[1,"btn-pagination",3,"click","disabled"],[1,"page-numbers"],[1,"plan-row"],[1,"plan-name-cell"],[1,"plan-name"],[1,"duration-badge"],[1,"objective-chip"],[1,"status-badge"],[1,"date-cell"],[1,"actions-cell"],["title","Ver detalles",1,"btn-icon",3,"routerLink"],["title","Editar",1,"btn-icon",3,"routerLink"],["title","Eliminar",1,"btn-icon","btn-delete",3,"click","disabled"],[1,"page-ellipsis"],[1,"page-number",3,"active"],[1,"page-number",3,"click"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3)(4,"mat-icon"),o(5,"restaurant_menu"),i(),o(6," Gesti\xF3n de Planes Nutricionales "),i(),a(7,"p",4),o(8,"Crea, edita y gestiona todos los planes nutricionales desde aqu\xED."),i()(),a(9,"button",5)(10,"mat-icon"),o(11,"add"),i(),o(12," Crear Nuevo Plan "),i()(),a(13,"mat-card",6)(14,"mat-card-content")(15,"div",7)(16,"mat-form-field",8)(17,"mat-label"),o(18,"Buscar planes"),i(),a(19,"input",9),y("ngModelChange",function(c){return E(n.filtroNombre,c)||(n.filtroNombre=c),c}),p("ngModelChange",function(){return n.filtrarPlanes()}),i(),a(20,"mat-icon",10),o(21,"search"),i()(),a(22,"mat-checkbox",11),y("ngModelChange",function(c){return E(n.mostrarInactivos,c)||(n.mostrarInactivos=c),c}),p("ngModelChange",function(){return n.cargarPlanes()}),o(23," Mostrar planes inactivos "),i()()()(),_(24,lt,5,0,"div",12),_(25,st,13,0,"mat-card"),_(26,ut,30,2),i()),t&2&&(l(19),S("ngModel",n.filtroNombre),l(3),S("ngModel",n.mostrarInactivos),l(2),b(n.loading()?24:-1),l(),b(!n.loading()&&n.planesFiltrados().length===0?25:-1),l(),b(!n.loading()&&n.planesFiltrados().length>0?26:-1))},dependencies:[I,F,W,V,j,B,q,U,$,z,D,R,T,Z,Y,K,H,J,X,et,tt,Q],styles:[".page-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto;background:#f5f5f5;min-height:100vh}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem}.header-content[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:2rem;color:#333}.page-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem;color:var(--primary-color, #00A859)}.page-subtitle[_ngcontent-%COMP%]{margin:0;color:#666;font-size:1rem}.filters-card[_ngcontent-%COMP%]{margin-bottom:2rem}.filters[_ngcontent-%COMP%]{display:flex;gap:1.5rem;align-items:center;flex-wrap:wrap}.search-field[_ngcontent-%COMP%]{flex:1;min-width:300px}mat-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a;border:1px solid #e2e8f0}.plans-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.plans-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f8f9fa;border-bottom:2px solid #e2e8f0}.plans-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem 1.5rem;text-align:left;font-size:.75rem;font-weight:600;color:#6c757d;text-transform:uppercase;letter-spacing:.05em}.plans-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e2e8f0;transition:background .15s}.plans-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.plans-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.plans-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.inactive[_ngcontent-%COMP%]{opacity:.6}.plans-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;font-size:.875rem;color:#212529}.plan-name-cell[_ngcontent-%COMP%]{font-weight:500}.plan-name[_ngcontent-%COMP%]{color:#2d3748;font-size:.95rem}.duration-badge[_ngcontent-%COMP%]{padding:.375rem .875rem;background:#edf2f7;color:#2d3748;border-radius:6px;font-size:.875rem;white-space:nowrap}.objective-chip[_ngcontent-%COMP%]{display:inline-block;padding:.375rem .875rem;background:#00a859;color:#fff;border-radius:16px;font-size:.8125rem;font-weight:500;margin-right:.5rem}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.375rem .875rem;border-radius:16px;font-size:.8125rem;font-weight:500}.status-badge.active[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.inactive[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.date-cell[_ngcontent-%COMP%]{color:#718096}.actions-cell[_ngcontent-%COMP%]{text-align:right}.actions-column[_ngcontent-%COMP%]{text-align:right;width:150px}.btn-icon[_ngcontent-%COMP%]{background:transparent;border:none;color:#718096;cursor:pointer;padding:.5rem;border-radius:6px;transition:all .2s;margin-left:.25rem}.btn-icon[_ngcontent-%COMP%]:hover{background:#edf2f7;color:#2d3748}.btn-icon.btn-delete[_ngcontent-%COMP%]:hover{background:#fff5f5;color:#e53e3e}.btn-icon[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.btn-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:.5rem;margin-top:2rem;padding:1rem}.btn-pagination[_ngcontent-%COMP%]{min-width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;padding:0 .75rem;background:#fff;color:#00a859;border:1px solid #dee2e6;border-radius:4px;cursor:pointer;transition:all .2s;font-size:.875rem;font-weight:500;gap:.25rem}.btn-pagination[_ngcontent-%COMP%]:hover:not(:disabled){background:#00a859;color:#fff;border-color:#00a859}.btn-pagination[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;color:#6c757d;background:#f8f9fa}.page-numbers[_ngcontent-%COMP%]{display:flex;gap:.25rem;align-items:center}.page-number[_ngcontent-%COMP%]{min-width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;background:#fff;color:#00a859;border:1px solid #dee2e6;border-radius:4px;cursor:pointer;transition:all .2s;font-size:.875rem;font-weight:500}.page-number[_ngcontent-%COMP%]:hover, .page-number.active[_ngcontent-%COMP%]{background:#00a859;color:#fff;border-color:#00a859}.page-ellipsis[_ngcontent-%COMP%]{color:#6c757d;padding:0 .25rem;font-weight:500}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#718096}.loading-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;margin-bottom:1rem;color:#00a859;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem;color:#ccc;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#333}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:1.5rem}"]})};export{it as ListaPlanesComponent};
