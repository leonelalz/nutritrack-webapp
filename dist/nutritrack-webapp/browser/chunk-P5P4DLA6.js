import{a as T}from"./chunk-5EP6LFYW.js";import{A as q,z as j}from"./chunk-7NAIVTKU.js";import{a as A}from"./chunk-AVXLCIQN.js";import"./chunk-Q53AFBXZ.js";import{b as k,d as w,e as I}from"./chunk-ONQJZTIX.js";import"./chunk-N5IZLMDI.js";import{$b as P,Bb as b,Db as d,Ec as y,Ma as r,Pb as S,Rb as a,Sa as g,Sb as p,Tb as u,Ub as D,Za as h,ba as _,ca as v,ma as x,mb as s,nb as m,pb as E,qb as M,rb as f,sb as n,tb as t,ub as O,zb as C}from"./chunk-D6HZ3QFW.js";import"./chunk-2VMXMS7J.js";var z=i=>["/admin/planes",i,"editar"],R=i=>["/admin/planes",i,"configurar"],N=(i,o)=>o.id;function V(i,o){i&1&&(n(0,"div",1),O(1,"div",3),n(2,"p"),a(3,"Cargando plan..."),t()())}function L(i,o){if(i&1){let e=C();n(0,"button",18),b("click",function(){_(e);let c=d(2);return v(c.confirmarDesactivar())}),a(1," Desactivar Plan "),t()}if(i&2){let e=d(2);f("disabled",e.plan().numeroUsuariosActivos&&e.plan().numeroUsuariosActivos>0)}}function U(i,o){if(i&1){let e=C();n(0,"button",19),b("click",function(){_(e);let c=d(2);return v(c.activarPlan())}),a(1," Activar Plan "),t()}}function $(i,o){if(i&1&&(n(0,"div",15)(1,"span",16),a(2,"Usuarios Activos:"),t(),n(3,"span",17),a(4),t()()),i&2){let e=d(2);r(4),p(e.plan().numeroUsuariosActivos)}}function B(i,o){if(i&1&&(n(0,"div",15)(1,"span",16),a(2,"Descripci\xF3n:"),t(),n(3,"p",17),a(4),t()()),i&2){let e=d(3);r(4),p(e.plan().objetivo.descripcion)}}function G(i,o){if(i&1&&(n(0,"div",14)(1,"h2"),a(2,"Objetivo Nutricional"),t(),s(3,B,5,1,"div",15),n(4,"div",20)(5,"div",21)(6,"span",22),a(7,"Calor\xEDas"),t(),n(8,"span",23),a(9),t()(),n(10,"div",21)(11,"span",22),a(12,"Prote\xEDnas"),t(),n(13,"span",23),a(14),t()(),n(15,"div",21)(16,"span",22),a(17,"Carbohidratos"),t(),n(18,"span",23),a(19),t()(),n(20,"div",21)(21,"span",22),a(22,"Grasas"),t(),n(23,"span",23),a(24),t()()()()),i&2){let e=d(2);r(3),m(e.plan().objetivo.descripcion?3:-1),r(6),u("",e.plan().objetivo.caloriasObjetivo," kcal"),r(5),u("",e.plan().objetivo.proteinasObjetivo," g"),r(5),u("",e.plan().objetivo.carbohidratosObjetivo," g"),r(5),u("",e.plan().objetivo.grasasObjetivo," g")}}function Y(i,o){if(i&1&&(n(0,"span",28),a(1),t()),i&2){let e=d().$implicit;r(),p(e.descripcion)}}function H(i,o){if(i&1&&(n(0,"div",25)(1,"span",26),a(2),t(),n(3,"span",27),a(4),t(),s(5,Y,2,1,"span",28),t()),i&2){let e=o.$implicit;r(2),p(e.tipoEtiqueta),r(2),p(e.nombre),r(),m(e.descripcion?5:-1)}}function J(i,o){if(i&1&&(n(0,"div",14)(1,"h2"),a(2,"Etiquetas"),t(),n(3,"div",24),E(4,H,6,3,"div",25,N),t()()),i&2){let e=d(2);r(4),M(e.plan().etiquetas)}}function K(i,o){if(i&1&&(n(0,"div",15)(1,"span",16),a(2,"Fecha de Creaci\xF3n:"),t(),n(3,"span",17),a(4),t()()),i&2){let e=d(2);r(4),p(e.formatearFecha(e.plan().createdAt))}}function Q(i,o){if(i&1&&(n(0,"div",15)(1,"span",16),a(2,"\xDAltima Modificaci\xF3n:"),t(),n(3,"span",17),a(4),t()()),i&2){let e=d(2);r(4),p(e.formatearFecha(e.plan().updatedAt))}}function W(i,o){if(i&1&&(n(0,"div",4)(1,"button",5),a(2," \u2190 Volver a planes "),t(),n(3,"div",6)(4,"button",7),a(5," Editar Plan "),t(),n(6,"button",7),a(7," Configurar D\xEDas "),t(),s(8,L,2,1,"button",8)(9,U,2,0,"button",9),t()(),n(10,"div",10)(11,"h1",11)(12,"mat-icon"),a(13,"restaurant_menu"),t(),a(14),t(),n(15,"span",12),a(16),t()(),n(17,"div",13)(18,"div",14)(19,"h2"),a(20,"Informaci\xF3n B\xE1sica"),t(),n(21,"div",15)(22,"span",16),a(23,"Descripci\xF3n:"),t(),n(24,"p",17),a(25),t()(),n(26,"div",15)(27,"span",16),a(28,"Duraci\xF3n:"),t(),n(29,"span",17),a(30),t()(),n(31,"div",15)(32,"span",16),a(33,"D\xEDas Programados:"),t(),n(34,"span",17),a(35),t()(),s(36,$,5,1,"div",15),t(),s(37,G,25,5,"div",14),s(38,J,6,0,"div",14),n(39,"div",14)(40,"h2"),a(41,"Informaci\xF3n de Registro"),t(),s(42,K,5,1,"div",15),s(43,Q,5,1,"div",15),t()()),i&2){let e=d();r(4),f("routerLink",P(18,z,e.plan().id)),r(2),f("routerLink",P(20,R,e.plan().id)),r(2),m(e.plan().activo?8:9),r(6),u(" ",e.plan().nombre," "),r(),S("active",e.plan().activo)("inactive",!e.plan().activo),r(),u(" ",e.plan().activo?"Activo":"Inactivo"," "),r(9),p(e.plan().descripcion),r(5),u("",e.plan().duracionDias," d\xEDas"),r(5),D("",e.plan().totalDiasProgramados||0," / ",e.plan().duracionDias),r(),m(e.plan().numeroUsuariosActivos!==void 0?36:-1),r(),m(e.plan().objetivo?37:-1),r(),m(e.plan().etiquetas&&e.plan().etiquetas.length>0?38:-1),r(4),m(e.plan().createdAt?42:-1),r(),m(e.plan().updatedAt?43:-1)}}function X(i,o){i&1&&(n(0,"div",2)(1,"h2"),a(2,"Plan no encontrado"),t(),n(3,"p"),a(4,"El plan solicitado no existe o fue eliminado."),t(),n(5,"button",29),a(6,"Volver a planes"),t()())}var F=class i{constructor(o,e,l,c){this.route=o;this.router=e;this.planService=l;this.notificationService=c}plan=x(null);cargando=x(!0);ngOnInit(){let o=this.route.snapshot.params.id;o&&this.cargarPlan(Number(o))}cargarPlan(o){this.cargando.set(!0),this.planService.obtenerPlanPorId(o).subscribe({next:e=>{this.cargando.set(!1),e.success&&e.data?this.plan.set(e.data):this.plan.set(null)},error:()=>{this.cargando.set(!1),this.plan.set(null),this.notificationService.showError("Error al cargar el plan")}})}formatearFecha(o){return o?new Date(o).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}confirmarDesactivar(){let o=this.plan();if(!o)return;confirm(`\xBFEst\xE1s seguro de desactivar el plan "${o.nombre}"?

El plan quedar\xE1 inactivo pero podr\xE1s reactivarlo m\xE1s tarde.`)&&this.planService.desactivarPlan(o.id).subscribe({next:l=>{l.success&&(this.notificationService.showSuccess("Plan desactivado exitosamente"),this.router.navigate(["/admin/planes"]))},error:l=>{console.log("Error completo:",l),console.log("Error.error:",l.error),console.log("Mensaje:",l.error?.message);let c=l.error?.message||l.error?.error||l.message||"";l.status===409||l.status===400?c||(c="El plan tiene usuarios activos y no puede ser desactivado"):l.status===404?c||(c="Plan no encontrado"):c||(c="Error al desactivar el plan"),this.notificationService.showError(c)}})}activarPlan(){let o=this.plan();o&&this.planService.activarPlan(o.id).subscribe({next:e=>{e.success&&(this.notificationService.showSuccess("Plan activado exitosamente"),this.cargarPlan(o.id))},error:e=>{let l=e.error?.message||e.error?.error||e.message||"Error al activar el plan";this.notificationService.showError(l)}})}static \u0275fac=function(e){return new(e||i)(g(k),g(w),g(T),g(A))};static \u0275cmp=h({type:i,selectors:[["app-detalle-plan"]],decls:4,vars:1,consts:[[1,"detalle-container"],[1,"loading"],[1,"error"],[1,"spinner"],[1,"header"],["routerLink","/admin/planes",1,"btn-back"],[1,"header-actions"],[1,"btn-secondary",3,"routerLink"],[1,"btn-danger",3,"disabled"],[1,"btn-success"],[1,"title-section"],[1,"page-title"],[1,"status-badge"],[1,"info-grid"],[1,"info-card"],[1,"info-item"],[1,"label"],[1,"value"],[1,"btn-danger",3,"click","disabled"],[1,"btn-success",3,"click"],[1,"macros-grid"],[1,"macro-item"],[1,"macro-label"],[1,"macro-value"],[1,"etiquetas-list"],[1,"etiqueta-badge"],[1,"etiqueta-tipo"],[1,"etiqueta-nombre"],[1,"etiqueta-desc"],["routerLink","/admin/planes",1,"btn-primary"]],template:function(e,l){e&1&&(n(0,"div",0),s(1,V,4,0,"div",1)(2,W,44,22)(3,X,7,0,"div",2),t()),e&2&&(r(),m(l.cargando()?1:l.plan()?2:3))},dependencies:[y,I,q,j],styles:[".detalle-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto;background:#f5f5f5;min-height:100vh}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.btn-back[_ngcontent-%COMP%]{background:none;border:none;color:#667eea;font-weight:600;cursor:pointer;font-size:1rem;padding:.5rem 0}.btn-back[_ngcontent-%COMP%]:hover{text-decoration:underline}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:.875rem}.btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-danger[_ngcontent-%COMP%]{background:#fc8181;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#f56565}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-success[_ngcontent-%COMP%]{background:#48bb78;color:#fff}.btn-success[_ngcontent-%COMP%]:hover{background:#38a169}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:#2d3748;margin:0}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.5rem 1rem;border-radius:20px;font-size:.875rem;font-weight:600}.status-badge.active[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.inactive[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:1.5rem}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;color:#2d3748;margin:0 0 1.5rem;padding-bottom:.75rem;border-bottom:2px solid #edf2f7}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;margin-bottom:1rem}.info-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.label[_ngcontent-%COMP%]{font-size:.875rem;color:#718096;font-weight:600}.value[_ngcontent-%COMP%]{font-size:1rem;color:#2d3748;margin:0}.macros-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.macro-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:1rem;background:#f7fafc;border-radius:8px;border:2px solid #e2e8f0}.macro-label[_ngcontent-%COMP%]{font-size:.75rem;color:#718096;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-bottom:.5rem}.macro-value[_ngcontent-%COMP%]{font-size:1.5rem;color:#00a859;font-weight:700}.etiquetas-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.etiqueta-badge[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:.75rem;background:#f7fafc;border-radius:8px;border-left:4px solid #00A859}.etiqueta-tipo[_ngcontent-%COMP%]{font-size:.625rem;color:#718096;font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-bottom:.25rem}.etiqueta-nombre[_ngcontent-%COMP%]{font-size:.875rem;color:#2d3748;font-weight:600;margin-bottom:.25rem}.etiqueta-desc[_ngcontent-%COMP%]{font-size:.75rem;color:#718096;font-style:italic}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:50vh;color:#718096}.spinner[_ngcontent-%COMP%]{width:3rem;height:3rem;border:4px solid #edf2f7;border-top-color:#00a859;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#fff;border-radius:12px}.error[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#e53e3e;margin-bottom:1rem}.error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;margin-bottom:1.5rem}@media (max-width: 768px){.info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.header-actions[_ngcontent-%COMP%]{width:100%;flex-direction:column}.btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%]{width:100%}.macros-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{F as DetallePlanComponent};
