import{a as $}from"./chunk-FAQLDPXB.js";import{a as L}from"./chunk-AVXLCIQN.js";import{c as I,g as N,j as k,p as T,q as j,r as z,w as V}from"./chunk-GRSFFSFU.js";import{a as D}from"./chunk-XET7WMBO.js";import{a as U}from"./chunk-Q53AFBXZ.js";import"./chunk-ONQJZTIX.js";import"./chunk-N5IZLMDI.js";import{Bb as P,Db as c,Ec as R,Lc as q,Ma as d,Qb as y,Rb as a,Sb as m,T as A,Tb as h,Vb as x,Wb as b,Xb as M,Y as u,Za as E,ba as p,ca as f,ma as C,mb as g,nb as _,pb as O,qb as w,sb as n,tb as i,zb as v}from"./chunk-D6HZ3QFW.js";import"./chunk-2VMXMS7J.js";var S=class o{http=u(q);apiUrl=`${U.apiUrl}/perfil`;obtenerPerfilCompleto(){return this.http.get(`${this.apiUrl}/completo`)}obtenerPerfilSalud(){return this.http.get(`${this.apiUrl}/salud`)}actualizarPerfilSalud(t){return this.http.put(`${this.apiUrl}/salud`,t)}agregarEtiqueta(t){return this.http.post(`${this.apiUrl}/salud/etiquetas/${t}`,{})}eliminarEtiqueta(t){return this.http.delete(`${this.apiUrl}/salud/etiquetas/${t}`)}registrarMedicion(t){return this.http.post(`${this.apiUrl}/mediciones`,t)}obtenerMediciones(){return this.http.get(`${this.apiUrl}/mediciones`)}obtenerMedicion(t){return this.http.get(`${this.apiUrl}/mediciones/${t}`)}actualizarMedicion(t,e){return this.http.put(`${this.apiUrl}/mediciones/${t}`,e)}eliminarMedicion(t){return this.http.delete(`${this.apiUrl}/mediciones/${t}`)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=A({token:o,factory:o.\u0275fac,providedIn:"root"})};var W=(o,t)=>t.id;function B(o,t){o&1&&(n(0,"div",5)(1,"p"),a(2,"Cargando perfil..."),i()())}function Y(o,t){if(o&1){let e=v();n(0,"select",20),M("ngModelChange",function(l){p(e);let r=c(2);return b(r.perfilSalud().objetivoActual,l)||(r.perfilSalud().objetivoActual=l),f(l)}),n(1,"option",21),a(2,"Perder Peso"),i(),n(3,"option",22),a(4,"Ganar M\xFAsculo"),i(),n(5,"option",23),a(6,"Mantener Peso"),i(),n(7,"option",24),a(8,"Mejorar Salud"),i()()}if(o&2){let e=c(2);x("ngModel",e.perfilSalud().objetivoActual)}}function J(o,t){if(o&1&&(n(0,"p"),a(1),i()),o&2){let e=c(2);d(),m(e.formatearObjetivo(e.perfilSalud().objetivoActual))}}function H(o,t){if(o&1){let e=v();n(0,"select",20),M("ngModelChange",function(l){p(e);let r=c(2);return b(r.perfilSalud().nivelActividadActual,l)||(r.perfilSalud().nivelActividadActual=l),f(l)}),n(1,"option",25),a(2,"Sedentario"),i(),n(3,"option",26),a(4,"Ligeramente Activo"),i(),n(5,"option",27),a(6,"Moderadamente Activo"),i(),n(7,"option",28),a(8,"Muy Activo"),i(),n(9,"option",29),a(10,"Extremadamente Activo"),i()()}if(o&2){let e=c(2);x("ngModel",e.perfilSalud().nivelActividadActual)}}function K(o,t){if(o&1&&(n(0,"p"),a(1),i()),o&2){let e=c(2);d(),m(e.formatearNivelActividad(e.perfilSalud().nivelActividadActual))}}function Q(o,t){if(o&1){let e=v();n(0,"textarea",30),M("ngModelChange",function(l){p(e);let r=c(2);return b(r.perfilSalud().notas,l)||(r.perfilSalud().notas=l),f(l)}),i()}if(o&2){let e=c(2);x("ngModel",e.perfilSalud().notas)}}function X(o,t){if(o&1&&(n(0,"p"),a(1),i()),o&2){let e=c(2);d(),m(e.perfilSalud().notas||"No hay notas adicionales")}}function Z(o,t){if(o&1){let e=v();n(0,"div",31)(1,"div",32)(2,"span",33),a(3),i(),n(4,"div")(5,"h4"),a(6),i(),n(7,"p"),a(8),i()()(),n(9,"button",34),P("click",function(){let l=p(e).$implicit,r=c(3);return f(r.eliminarEtiqueta(l.id))}),a(10," \u2715 "),i()()}if(o&2){let e=t.$implicit;d(2),y("badge-"+e.tipoEtiqueta.toLowerCase()),d(),h(" ",e.tipoEtiqueta," "),d(3),m(e.nombre),d(2),m(e.descripcion)}}function ee(o,t){if(o&1&&(n(0,"div",16),O(1,Z,11,5,"div",31,W),i()),o&2){let e=c(2);d(),w(e.perfilSalud().etiquetas)}}function te(o,t){o&1&&(n(0,"div",17)(1,"span",35),a(2,"\u{1F3F7}\uFE0F"),i(),n(3,"p"),a(4,"No tienes alergias o condiciones m\xE9dicas registradas"),i()())}function ie(o,t){if(o&1){let e=v();n(0,"div",6)(1,"div",7)(2,"div",8)(3,"h3"),a(4,"Perfil de Salud"),i(),n(5,"button",9),P("click",function(){p(e);let l=c();return f(l.toggleEdit())}),a(6),i()(),n(7,"div",10)(8,"div",11)(9,"div",12)(10,"label"),a(11,"Objetivo Nutricional"),i(),g(12,Y,9,1,"select",13)(13,J,2,1,"p"),i(),n(14,"div",12)(15,"label"),a(16,"Nivel de Actividad"),i(),g(17,H,11,1,"select",13)(18,K,2,1,"p"),i(),n(19,"div",14)(20,"label"),a(21,"Notas Adicionales"),i(),g(22,Q,1,1,"textarea",15)(23,X,2,1,"p"),i()()()(),n(24,"div",7)(25,"div",8)(26,"h3"),a(27,"Alergias y Condiciones M\xE9dicas"),i()(),n(28,"div",10),g(29,ee,3,0,"div",16)(30,te,5,0,"div",17),i()(),n(31,"div",7)(32,"div",8)(33,"h3"),a(34,"Informaci\xF3n de Usuario"),i()(),n(35,"div",10)(36,"div",18)(37,"div",19)(38,"label"),a(39,"Nombre de Usuario"),i(),n(40,"p"),a(41),i()(),n(42,"div",19)(43,"label"),a(44,"Email"),i(),n(45,"p"),a(46),i()(),n(47,"div",19)(48,"label"),a(49,"Rol"),i(),n(50,"p"),a(51),i()()()()()()}if(o&2){let e,s,l,r=c();d(6),h(" ",r.editando()?"Guardar Cambios":"Editar"," "),d(6),_(r.editando()?12:13),d(5),_(r.editando()?17:18),d(5),_(r.editando()?22:23),d(7),_(r.perfilSalud().etiquetas&&r.perfilSalud().etiquetas.length>0?29:30),d(12),m(((e=r.currentUser())==null?null:e.username)||"No disponible"),d(5),m(((s=r.currentUser())==null?null:s.email)||"No disponible"),d(5),m(((l=r.currentUser())==null?null:l.role)||"Usuario")}}var F=class o{perfilService=u(S);notificationService=u(L);authService=u(D);mockData=u($);cargando=C(!0);editando=C(!1);perfilSalud=this.mockData.perfilSalud;currentUser=C(null);ngOnInit(){this.loadCurrentUser(),this.loadPerfilSalud()}loadCurrentUser(){let t=this.authService.currentUser();this.currentUser.set(t)}loadPerfilSalud(){this.cargando.set(!0),this.perfilService.obtenerPerfilCompleto().subscribe({next:t=>{if(t.success&&t.data){let e=t.data;this.perfilSalud.set({id:e.perfilSalud.id,objetivoActual:e.perfilSalud.objetivoActual,nivelActividadActual:e.perfilSalud.nivelActividadActual,notas:null,etiquetas:e.perfilSalud.etiquetas}),this.currentUser.set({username:e.nombreCompleto,email:e.email,role:e.rol}),this.cargando.set(!1)}else this.cargarDatosDemo()},error:()=>{this.cargarDatosDemo(),this.notificationService.showSuccess("Modo demo: perfil cargado sin conexi\xF3n")}})}cargarDatosDemo(){this.perfilSalud.set({id:1,objetivoActual:"PERDER_PESO",nivelActividadActual:"MODERADO",notas:"Perfil de demostraci\xF3n",etiquetas:[{id:1,nombre:"Sin Gluten",tipoEtiqueta:"ALERGIA",descripcion:"Alergia al gluten"},{id:2,nombre:"Lactosa",tipoEtiqueta:"ALERGIA",descripcion:"Intolerancia a la lactosa"}]}),this.currentUser.set({username:"Usuario Demo",email:"demo@nutritrack.com",role:"USER"}),this.cargando.set(!1)}toggleEdit(){this.editando()?this.guardarCambios():this.editando.set(!0)}guardarCambios(){let t=this.perfilSalud();this.mockData.actualizarPerfilSalud({objetivoActual:t.objetivoActual,nivelActividadActual:t.nivelActividadActual,notas:t.notas}),this.perfilService.actualizarPerfilSalud({objetivoActual:t.objetivoActual,nivelActividadActual:t.nivelActividadActual,notas:t.notas}).subscribe({next:e=>{e.success?this.notificationService.showSuccess("Perfil actualizado correctamente"):this.notificationService.showSuccess("Perfil actualizado (demo)"),this.editando.set(!1)},error:()=>{this.notificationService.showSuccess("Perfil actualizado (demo)"),this.editando.set(!1)}})}eliminarEtiqueta(t){confirm("\xBFEst\xE1s seguro de eliminar esta etiqueta?")&&(this.mockData.eliminarEtiqueta(t),this.perfilService.eliminarEtiqueta(t).subscribe({next:e=>{e.success?this.notificationService.showSuccess("Etiqueta eliminada"):this.notificationService.showSuccess("Etiqueta eliminada (demo)")},error:()=>{this.notificationService.showSuccess("Etiqueta eliminada (demo)")}}))}formatearObjetivo(t){return{PERDER_PESO:"Perder Peso",GANAR_MUSCULO:"Ganar M\xFAsculo",MANTENER_PESO:"Mantener Peso",MEJORAR_SALUD:"Mejorar Salud"}[t]||t}formatearNivelActividad(t){return{SEDENTARIO:"Sedentario",LIGERO:"Ligeramente Activo",MODERADO:"Moderadamente Activo",ACTIVO:"Muy Activo",MUY_ACTIVO:"Extremadamente Activo"}[t]||t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-mi-perfil"]],decls:10,vars:1,consts:[[1,"mi-perfil-container"],[1,"page-header"],[1,"page-title"],[1,"icon"],[1,"page-subtitle"],[1,"loading-state"],[1,"content-layout"],[1,"content-card"],[1,"card-header"],[1,"btn-edit",3,"click"],[1,"card-content"],[1,"form-grid"],[1,"form-field"],[3,"ngModel"],[1,"form-field","full-width"],["rows","3","placeholder","Ingresa notas sobre tu salud",3,"ngModel"],[1,"etiquetas-list"],[1,"empty-state"],[1,"info-grid"],[1,"info-field"],[3,"ngModelChange","ngModel"],["value","PERDER_PESO"],["value","GANAR_MUSCULO"],["value","MANTENER_PESO"],["value","MEJORAR_SALUD"],["value","SEDENTARIO"],["value","LIGERO"],["value","MODERADO"],["value","ACTIVO"],["value","MUY_ACTIVO"],["rows","3","placeholder","Ingresa notas sobre tu salud",3,"ngModelChange","ngModel"],[1,"etiqueta-item"],[1,"etiqueta-info"],[1,"etiqueta-badge"],["title","Eliminar etiqueta",1,"btn-remove",3,"click"],[1,"empty-icon"]],template:function(e,s){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),a(4,"\u{1F464}"),i(),a(5," Mi Perfil de Salud "),i(),n(6,"p",4),a(7,"Gestiona tu informaci\xF3n de salud y objetivos nutricionales"),i()(),g(8,B,3,0,"div",5)(9,ie,52,8,"div",6),i()),e&2&&(d(8),_(s.cargando()?8:9))},dependencies:[R,V,j,z,I,T,N,k],styles:[".mi-perfil-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:2rem;font-weight:700;color:#2d3748}.page-title[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2.5rem}.page-subtitle[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:1.1rem}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.content-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.content-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:#2d3748}.btn-edit[_ngcontent-%COMP%]{padding:.5rem 1rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:6px;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s}.btn-edit[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #667eea4d}.card-content[_ngcontent-%COMP%]{padding:1.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#718096;font-size:.875rem;font-weight:600}.form-field[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:1rem;padding:.75rem;background:#f7fafc;border-radius:6px}.form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #e2e8f0;border-radius:6px;font-size:1rem;color:#2d3748;background:#fff}.form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.etiquetas-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.etiqueta-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#f7fafc;border-radius:8px;border-left:4px solid #667eea}.etiqueta-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1}.etiqueta-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:700;text-transform:uppercase;flex-shrink:0}.badge-alergia[_ngcontent-%COMP%]{background:#fee;color:#c53030}.badge-condicion[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.etiqueta-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;color:#2d3748;font-size:1rem}.etiqueta-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:.875rem;padding:0;background:none}.btn-remove[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:none;background:#fed7d7;color:#c53030;font-size:1.25rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.btn-remove[_ngcontent-%COMP%]:hover{background:#c53030;color:#fff}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;color:#a0aec0}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;display:block;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;padding:0;background:none}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.info-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.info-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#718096;font-size:.875rem;font-weight:600}.info-field[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:1rem;padding:.75rem;background:#f7fafc;border-radius:6px}@media (max-width: 768px){.mi-perfil-container[_ngcontent-%COMP%]{padding:1rem}.form-grid[_ngcontent-%COMP%], .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{F as MiPerfilComponent};
