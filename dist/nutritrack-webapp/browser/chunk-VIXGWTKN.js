import{a as F}from"./chunk-73PQWT7O.js";import{a as I}from"./chunk-AVXLCIQN.js";import"./chunk-Q53AFBXZ.js";import{e as V}from"./chunk-ONQJZTIX.js";import"./chunk-N5IZLMDI.js";import{Bb as C,Db as l,Ec as D,Ma as a,Ob as O,Qb as k,Rb as r,Sa as P,Sb as x,Tb as v,Ub as y,Za as T,_b as b,ba as p,ca as u,ma as h,mb as m,nb as _,pb as w,qb as A,rb as f,sb as o,tb as n,ub as E,zb as g}from"./chunk-D6HZ3QFW.js";import{a as M,b as S}from"./chunk-2VMXMS7J.js";var j=()=>["/metas/planes"],N=()=>["/metas/rutinas"],L=(i,t)=>t.id;function z(i,t){i&1&&(o(0,"div",3)(1,"p"),r(2,"Cargando tus asignaciones..."),n()())}function $(i,t){i&1&&(o(0,"div",7)(1,"p"),r(2,"No tienes planes activos"),n(),o(3,"button",10),r(4," Explorar planes disponibles "),n()()),i&2&&(a(3),f("routerLink",b(1,j)))}function U(i,t){if(i&1){let e=g();o(0,"button",27),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.pausarPlan(c.id))}),r(1," Pausar "),n()}}function Y(i,t){if(i&1){let e=g();o(0,"button",27),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.reanudarPlan(c.id))}),r(1," Reanudar "),n()}}function G(i,t){if(i&1){let e=g();o(0,"button",28),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.completarPlan(c.id))}),r(1," Marcar Completado "),n()}}function q(i,t){if(i&1){let e=g();o(0,"div",11)(1,"div",12)(2,"h3"),r(3),n(),o(4,"span",13),r(5),n()(),o(6,"div",14)(7,"div",15)(8,"span"),r(9),n(),o(10,"span",16),r(11),n()(),o(12,"div",17),E(13,"div",18),n()(),o(14,"div",19)(15,"div",20)(16,"span",21),r(17,"Fecha Inicio:"),n(),o(18,"span",22),r(19),n()()(),o(20,"div",23),m(21,U,2,0,"button",24),m(22,Y,2,0,"button",24),o(23,"button",25),C("click",function(){let c=p(e).$implicit,d=l(3);return u(d.cancelarPlan(c.id))}),r(24," Cancelar "),n(),m(25,G,2,0,"button",26),n()()}if(i&2){let e=t.$implicit,s=l(3);a(3),x(e.planNombre),a(),k("estado-"+e.estado.toLowerCase()),a(),v(" ",s.formatearEstado(e.estado)," "),a(4),y("D\xEDa ",e.diaActual," de ",e.diasTotales),a(2),v("",e.porcentajeCompletado,"%"),a(2),O("width",e.porcentajeCompletado,"%"),a(6),x(s.formatearFecha(e.fechaInicio)),a(2),_(e.estado==="ACTIVO"?21:-1),a(),_(e.estado==="PAUSADO"?22:-1),a(3),_(e.estado==="ACTIVO"||e.estado==="PAUSADO"?25:-1)}}function B(i,t){if(i&1&&(o(0,"div",8),w(1,q,26,13,"div",11,L),n()),i&2){let e=l(2);a(),A(e.planesActivos())}}function H(i,t){i&1&&(o(0,"div",7)(1,"p"),r(2,"No tienes rutinas activas"),n(),o(3,"button",10),r(4," Explorar rutinas disponibles "),n()()),i&2&&(a(3),f("routerLink",b(1,N)))}function J(i,t){if(i&1){let e=g();o(0,"button",27),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.pausarRutina(c.id))}),r(1," Pausar "),n()}}function K(i,t){if(i&1){let e=g();o(0,"button",27),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.reanudarRutina(c.id))}),r(1," Reanudar "),n()}}function Q(i,t){if(i&1){let e=g();o(0,"button",28),C("click",function(){p(e);let c=l().$implicit,d=l(3);return u(d.completarRutina(c.id))}),r(1," Marcar Completado "),n()}}function W(i,t){if(i&1){let e=g();o(0,"div",11)(1,"div",12)(2,"h3"),r(3),n(),o(4,"span",13),r(5),n()(),o(6,"div",14)(7,"div",15)(8,"span"),r(9),n(),o(10,"span",16),r(11),n()(),o(12,"div",17),E(13,"div",18),n()(),o(14,"div",19)(15,"div",20)(16,"span",21),r(17,"Fecha Inicio:"),n(),o(18,"span",22),r(19),n()()(),o(20,"div",23),m(21,J,2,0,"button",24),m(22,K,2,0,"button",24),o(23,"button",25),C("click",function(){let c=p(e).$implicit,d=l(3);return u(d.cancelarRutina(c.id))}),r(24," Cancelar "),n(),m(25,Q,2,0,"button",26),n()()}if(i&2){let e=t.$implicit,s=l(3);a(3),x(e.rutinaNombre),a(),k("estado-"+e.estado.toLowerCase()),a(),v(" ",s.formatearEstado(e.estado)," "),a(4),y("D\xEDa ",e.diaActual," de ",e.diasTotales),a(2),v("",e.porcentajeCompletado,"%"),a(2),O("width",e.porcentajeCompletado,"%"),a(6),x(s.formatearFecha(e.fechaInicio)),a(2),_(e.estado==="ACTIVO"?21:-1),a(),_(e.estado==="PAUSADO"?22:-1),a(3),_(e.estado==="ACTIVO"||e.estado==="PAUSADO"?25:-1)}}function X(i,t){if(i&1&&(o(0,"div",8),w(1,W,26,13,"div",11,L),n()),i&2){let e=l(2);a(),A(e.rutinasActivas())}}function Z(i,t){if(i&1&&(o(0,"section",4)(1,"div",5)(2,"h2"),r(3,"Planes Nutricionales Activos"),n(),o(4,"button",6),r(5," Ver todos los planes "),n()(),m(6,$,5,2,"div",7),m(7,B,3,0,"div",8),n(),o(8,"section",9)(9,"div",5)(10,"h2"),r(11,"Rutinas Activas"),n(),o(12,"button",6),r(13," Ver todas las rutinas "),n()(),m(14,H,5,2,"div",7),m(15,X,3,0,"div",8),n()),i&2){let e=l();a(4),f("routerLink",b(6,j)),a(2),_(e.planesActivos().length===0?6:-1),a(),_(e.planesActivos().length>0?7:-1),a(5),f("routerLink",b(7,N)),a(2),_(e.rutinasActivas().length===0?14:-1),a(),_(e.rutinasActivas().length>0?15:-1)}}var R=class i{constructor(t,e){this.metasService=t;this.notificationService=e}loading=h(!1);planesActivos=h([]);rutinasActivas=h([]);ngOnInit(){this.cargarAsignaciones()}cargarAsignaciones(){this.loading.set(!0),Promise.all([this.metasService.obtenerPlanesActivos().toPromise(),this.metasService.obtenerRutinasActivas().toPromise()]).then(([t,e])=>{if(this.loading.set(!1),t?.success){let s=(t.data||[]).map(c=>S(M({},c),{diasTotales:c.planDuracionDias||c.duracionDias||0,porcentajeCompletado:this.calcularPorcentaje(c.diaActual||0,c.planDuracionDias||c.duracionDias||0)}));this.planesActivos.set(s)}if(e?.success){let s=(e.data||[]).map(c=>S(M({},c),{diasTotales:c.rutinaDuracionDias||c.duracionDias||0,porcentajeCompletado:this.calcularPorcentaje(c.diaActual||0,c.rutinaDuracionDias||c.duracionDias||0)}));this.rutinasActivas.set(s)}}).catch(()=>{this.loading.set(!1),this.notificationService.showError("Error al cargar asignaciones")})}calcularPorcentaje(t,e){return e===0?0:Math.round(t/e*100)}pausarPlan(t){this.metasService.pausarPlan(t).subscribe({next:()=>{this.notificationService.showSuccess("Plan pausado"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al pausar plan")})}reanudarPlan(t){this.metasService.reanudarPlan(t).subscribe({next:()=>{this.notificationService.showSuccess("Plan reanudado"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al reanudar plan")})}completarPlan(t){this.metasService.completarPlan(t).subscribe({next:()=>{this.notificationService.showSuccess("Plan completado"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al completar plan")})}cancelarPlan(t){this.metasService.cancelarPlan(t).subscribe({next:()=>{this.notificationService.showSuccess("Plan cancelado"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al cancelar plan")})}pausarRutina(t){this.metasService.pausarRutina(t).subscribe({next:()=>{this.notificationService.showSuccess("Rutina pausada"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al pausar rutina")})}reanudarRutina(t){this.metasService.reanudarRutina(t).subscribe({next:()=>{this.notificationService.showSuccess("Rutina reanudada"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al reanudar rutina")})}completarRutina(t){this.metasService.completarRutina(t).subscribe({next:()=>{this.notificationService.showSuccess("Rutina completada"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al completar rutina")})}cancelarRutina(t){this.metasService.cancelarRutina(t).subscribe({next:()=>{this.notificationService.showSuccess("Rutina cancelada"),this.cargarAsignaciones()},error:()=>this.notificationService.showError("Error al cancelar rutina")})}formatearEstado(t){return{ACTIVO:"Activo",PAUSADO:"Pausado",COMPLETADO:"Completado",CANCELADO:"Cancelado"}[t]||t}formatearFecha(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}static \u0275fac=function(e){return new(e||i)(P(F),P(I))};static \u0275cmp=T({type:i,selectors:[["app-mis-asignaciones"]],decls:8,vars:2,consts:[[1,"mis-asignaciones-container"],[1,"header"],[1,"subtitle"],[1,"loading"],[1,"planes-section"],[1,"section-header"],[1,"btn-view-all",3,"routerLink"],[1,"empty-state"],[1,"asignaciones-grid"],[1,"rutinas-section"],[1,"btn-link",3,"routerLink"],[1,"asignacion-card"],[1,"card-header"],[1,"estado-badge"],[1,"progress-info"],[1,"progress-text"],[1,"percentage"],[1,"progress-bar"],[1,"progress-fill"],[1,"card-info"],[1,"info-item"],[1,"label"],[1,"value"],[1,"card-actions"],[1,"btn-secondary"],[1,"btn-danger",3,"click"],[1,"btn-success"],[1,"btn-secondary",3,"click"],[1,"btn-success",3,"click"]],template:function(e,s){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Mis Planes y Rutinas"),n(),o(4,"p",2),r(5,"Gestiona tus asignaciones activas"),n()(),m(6,z,3,0,"div",3),m(7,Z,16,8),n()),e&2&&(a(6),_(s.loading()?6:-1),a(),_(s.loading()?-1:7))},dependencies:[D,V],styles:[".mis-asignaciones-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:3rem;text-align:center}h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#2d3748;margin:0 0 .5rem}.subtitle[_ngcontent-%COMP%]{color:#718096;font-size:1.125rem;margin:0}section[_ngcontent-%COMP%]{margin-bottom:3rem}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem}section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2d3748;margin:0;font-size:1.5rem}.btn-view-all[_ngcontent-%COMP%]{padding:.625rem 1.25rem;background:#667eea;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:.875rem;transition:all .2s;white-space:nowrap}.btn-view-all[_ngcontent-%COMP%]:hover{background:#764ba2;transform:translateY(-1px);box-shadow:0 2px 8px #667eea4d}.asignaciones-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.asignacion-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;display:flex;flex-direction:column;transition:transform .2s,box-shadow .2s}.asignacion-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;gap:1rem}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:1.25rem;flex:1}.estado-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:600;white-space:nowrap}.estado-badge.estado-activo[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.estado-badge.estado-pausado[_ngcontent-%COMP%]{background:#bee3f8;color:#2c5282}.estado-badge.estado-completado[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.estado-badge.estado-cancelado[_ngcontent-%COMP%]{background:#fed7d7;color:#742a2a}.progress-info[_ngcontent-%COMP%]{margin-bottom:1rem}.progress-text[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;font-size:.875rem;color:#718096}.percentage[_ngcontent-%COMP%]{font-weight:600;color:#2d3748}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e2e8f0;border-radius:10px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#48bb78,#38a169);transition:width .3s ease}.card-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem;padding:1rem;background:#f7fafc;border-radius:8px}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.875rem}.info-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#718096}.info-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#2d3748;font-weight:600}.card-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:auto}.btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:.75rem;transition:all .2s;flex:1;min-width:80px}.btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-danger[_ngcontent-%COMP%]{background:#fed7d7;color:#742a2a}.btn-danger[_ngcontent-%COMP%]:hover{background:#fc8181}.btn-success[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.btn-success[_ngcontent-%COMP%]:hover{background:#9ae6b4}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#f7fafc;border-radius:12px;color:#718096}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#667eea;font-weight:600;cursor:pointer;text-decoration:underline;font-size:1rem}.btn-link[_ngcontent-%COMP%]:hover{color:#764ba2}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#718096}"]})};export{R as MisAsignacionesComponent};
