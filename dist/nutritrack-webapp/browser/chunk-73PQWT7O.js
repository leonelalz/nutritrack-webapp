import{a as p}from"./chunk-Q53AFBXZ.js";import{Lc as A,N as b,T as d,X as R,c as n,n as y}from"./chunk-D6HZ3QFW.js";var f=class u{constructor(e){this.http=e}usuarioUrl=`${p.apiUrl}/usuario`;obtenerPlanesActivos(){return this.http.get(`${this.usuarioUrl}/planes/activos`)}obtenerHistorialPlanes(){return this.http.get(`${this.usuarioUrl}/planes`)}obtenerTodosLosPlanesDeUsuario(){return this.obtenerHistorialPlanes()}obtenerRutinasActivas(){return this.http.get(`${this.usuarioUrl}/rutinas/activas`)}obtenerHistorialRutinas(){return this.http.get(`${this.usuarioUrl}/rutinas`)}obtenerTodasLasRutinasDeUsuario(){return this.obtenerHistorialRutinas()}activarPlan(e){return this.http.post(`${this.usuarioUrl}/planes/activar`,e)}pausarPlan(e){return this.http.patch(`${this.usuarioUrl}/planes/${e}/pausar`,{})}reanudarPlan(e){return this.http.patch(`${this.usuarioUrl}/planes/${e}/reanudar`,{})}completarPlan(e){return this.http.patch(`${this.usuarioUrl}/planes/${e}/completar`,{})}cancelarPlan(e){return this.http.patch(`${this.usuarioUrl}/planes/${e}/cancelar`,{})}activarRutina(e){return this.http.post(`${this.usuarioUrl}/rutinas/activar`,e)}pausarRutina(e){return this.http.patch(`${this.usuarioUrl}/rutinas/${e}/pausar`,{})}reanudarRutina(e){return this.http.patch(`${this.usuarioUrl}/rutinas/${e}/reanudar`,{})}completarRutina(e){return this.http.patch(`${this.usuarioUrl}/rutinas/${e}/completar`,{})}cancelarRutina(e){return this.http.patch(`${this.usuarioUrl}/rutinas/${e}/cancelar`,{})}obtenerComidasProgramadasHoy(){return this.obtenerPlanesActivos().pipe(b(e=>{if(!e.success||!e.data||e.data.length===0)return new n(t=>{t.next({success:!0,data:[],message:"No hay planes activos"}),t.complete()});let a=e.data[0],c=a.plan?.id||a.planId,l=new Date(a.fechaInicio),h=new Date().getTime()-l.getTime(),r=Math.floor(h/(1e3*60*60*24))+1;return r<=0?new n(t=>{t.next({success:!0,data:[],message:"El plan a\xFAn no ha comenzado"}),t.complete()}):this.http.get(`${p.apiUrl}/planes/${c}/dias/${r}`)}))}obtenerEjerciciosProgramadosHoy(){return this.obtenerRutinasActivas().pipe(b(e=>{if(!e.success||!e.data||e.data.length===0)return new n(s=>{s.next({success:!0,data:[],message:"No hay rutinas activas"}),s.complete()});let a=e.data[0],c=a.rutina?.id||a.rutinaId,l=new Date(a.fechaInicio),h=new Date().getTime()-l.getTime(),i=Math.floor(h/(1e3*60*60*24));if(i<0)return new n(s=>{s.next({success:!0,data:[],message:"La rutina a\xFAn no ha comenzado"}),s.complete()});let r=Math.floor(i/7)+1,t=i%7+1;return this.http.get(`${p.apiUrl}/rutinas/${c}/ejercicios`).pipe(y(s=>{if(!s.success||!s.data)return{success:!0,data:[],message:"No hay ejercicios"};let m=s.data.filter(o=>o.semanaBase===r&&o.diaSemana===t).sort((o,g)=>o.orden-g.orden);return{success:!0,data:m,message:`${m.length} ejercicios para hoy`}}))}))}registrarComidaConsumida(e){return this.http.post(`${this.usuarioUrl}/registros/comida`,e)}registrarEjercicioCompletado(e){return this.http.post(`${this.usuarioUrl}/registros/ejercicio`,e)}static \u0275fac=function(a){return new(a||u)(R(A))};static \u0275prov=d({token:u,factory:u.\u0275fac,providedIn:"root"})};export{f as a};
