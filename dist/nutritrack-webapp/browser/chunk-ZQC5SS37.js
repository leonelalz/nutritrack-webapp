import{a as U,b as $}from"./chunk-45K44HJ4.js";import"./chunk-52HFRQ2W.js";import"./chunk-MX7IPDJP.js";import"./chunk-UC67PKK3.js";import{a as Y}from"./chunk-OBWTC55X.js";import{g as z,j as F,p as D,q as R,r as B,w as W}from"./chunk-M75YHKAC.js";import{a as L}from"./chunk-F5B3K5RO.js";import{a as G}from"./chunk-ILKCMMAD.js";import"./chunk-6ULEJF3H.js";import{c as j}from"./chunk-LBN5CU62.js";import"./chunk-NZVHEJ25.js";import{Bb as g,Db as _,Fb as l,Gc as A,Kc as N,Na as o,Qb as I,Rb as M,Tb as d,Ub as h,Vb as S,Xb as E,Yb as P,Z as b,Zb as T,_a as V,ca as m,cb as k,da as u,na as O,nb as f,ob as C,qb as y,rb as v,sb as x,tb as c,ub as r,vb as a,wb as q}from"./chunk-N5FZ7NRP.js";import"./chunk-2VMXMS7J.js";var H=(t,n)=>n.id;function J(t,n){if(t&1&&(r(0,"option",10),d(1),a()),t&2){let e=n.$implicit;c("ngValue",e),o(),h(e)}}function K(t,n){if(t&1){let e=g();r(0,"div",5)(1,"label"),d(2,"\xBFCu\xE1l es tu objetivo nutricional?"),a(),r(3,"select",9),T("ngModelChange",function(s){m(e);let p=l();return P(p.form.objetivo,s)||(p.form.objetivo=s),u(s)}),r(4,"option",10),d(5,"Selecciona un objetivo"),a(),v(6,J,2,2,"option",10,y),a()()}if(t&2){let e=l();o(3),E("ngModel",e.form.objetivo),o(),c("ngValue",void 0),o(2),x(e.objetivos)}}function Q(t,n){if(t&1&&(r(0,"option",10),d(1),a()),t&2){let e=n.$implicit;c("ngValue",e),o(),h(e)}}function X(t,n){if(t&1){let e=g();r(0,"div",5)(1,"label"),d(2,"\xBFCu\xE1l es tu nivel de actividad?"),a(),r(3,"select",9),T("ngModelChange",function(s){m(e);let p=l();return P(p.form.nivelActividad,s)||(p.form.nivelActividad=s),u(s)}),r(4,"option",10),d(5,"Selecciona un nivel"),a(),v(6,Q,2,2,"option",10,y),a()()}if(t&2){let e=l();o(3),E("ngModel",e.form.nivelActividad),o(),c("ngValue",void 0),o(2),x(e.niveles)}}function Z(t,n){if(t&1){let e=g();r(0,"button",14),_("click",function(){let s=m(e).$implicit,p=l(2);return u(p.toggleTag(s.id))}),d(1),a()}if(t&2){let e=n.$implicit,i=l(2);M("selected",i.isSelected(e.id)),o(),S(" ",e.nombre," ")}}function ee(t,n){if(t&1){let e=g();r(0,"button",14),_("click",function(){let s=m(e).$implicit,p=l(2);return u(p.toggleTag(s.id))}),d(1),a()}if(t&2){let e=n.$implicit,i=l(2);M("selected",i.isSelected(e.id)),o(),S(" ",e.nombre," ")}}function te(t,n){if(t&1&&(r(0,"div",5)(1,"label"),d(2,"Alergias y Condiciones M\xE9dicas"),a(),r(3,"div",11)(4,"h4"),d(5,"Alergias"),a(),r(6,"div",12),v(7,Z,2,3,"button",13,H),a(),r(9,"h4"),d(10,"Condiciones M\xE9dicas"),a(),r(11,"div",12),v(12,ee,2,3,"button",13,H),a()()()),t&2){let e=l();o(7),x(e.alergias()),o(5),x(e.condiciones())}}function ne(t,n){if(t&1){let e=g();r(0,"button",15),_("click",function(){m(e);let s=l();return u(s.nextStep())}),d(1," Siguiente "),a()}if(t&2){let e=l();c("disabled",!e.canContinue())}}function ie(t,n){if(t&1){let e=g();r(0,"button",15),_("click",function(){m(e);let s=l();return u(s.finalizar())}),d(1),a()}if(t&2){let e=l();c("disabled",e.loading()),o(),S(" ",e.loading()?"Guardando...":"Finalizar"," ")}}function oe(t,n){if(t&1){let e=g();r(0,"button",16),_("click",function(){m(e);let s=l();return u(s.prevStep())}),d(1," Atr\xE1s "),a()}if(t&2){let e=l();c("disabled",e.step()===0||e.loading())}}var w=class t{router=b(j);ns=b(L);perfilService=b(G);etiquetaService=b(Y);loading=O(!1);etiquetas=O([]);step=O(0);totalSteps=3;stepTitles=["\xBFCu\xE1l es tu objetivo?","Nivel de Actividad","Salud y Restricciones","Resumen Final"];stepSubtitles=["Esto nos ayuda a personalizar tus metas.","Determina cu\xE1nto debes consumir al d\xEDa.","Para evitar alimentos que no puedas consumir.","Confirma tus datos antes de comenzar."];objetivos=Object.values(U);niveles=Object.values($);form={objetivo:void 0,nivelActividad:void 0,etiquetas:[]};constructor(){this.cargarEtiquetas()}cargarEtiquetas(){this.etiquetaService.obtenerTodas().subscribe(n=>{this.etiquetas.set(n.data||[])})}alergias(){return this.etiquetas().filter(n=>n.tipoEtiqueta?.toUpperCase()==="ALERGIA")}condiciones(){return this.etiquetas().filter(n=>n.tipoEtiqueta?.toUpperCase()==="CONDICION_MEDICA")}isSelected(n){return this.form.etiquetas.includes(n)}toggleTag(n){let e=this.form.etiquetas,i=e.indexOf(n);i>=0?e.splice(i,1):e.push(n)}getEtiquetaNombre(n){return this.etiquetas().find(e=>e.id===n)?.nombre||""}nextStep(){this.step()<this.totalSteps-1&&this.step.set(this.step()+1)}prevStep(){this.step()>0&&this.step.set(this.step()-1)}canContinue(){return this.step()===0?!!this.form.objetivo:this.step()===1?!!this.form.nivelActividad:!0}finalizar(){this.loading.set(!0);let n={objetivoActual:this.form.objetivo,nivelActividadActual:this.form.nivelActividad,etiquetasId:this.form.etiquetas};this.perfilService.actualizarPerfilSalud(n).subscribe({next:e=>{this.loading.set(!1),e.success&&(this.ns.success("Onboarding","Tu perfil ha sido configurado."),this.router.navigate(["/dashboard"]))},error:()=>{this.loading.set(!1),this.ns.error("Onboarding","Ocurri\xF3 un error al guardar.")}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=V({type:t,selectors:[["app-onboarding"]],decls:14,vars:10,consts:[[1,"onboarding-container"],[1,"progress-wrapper"],[1,"progress-bar"],[1,"title"],[1,"subtitle"],[1,"card","fade-in"],[1,"nav-buttons"],["class","btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn-secondary",3,"disabled"],[3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"tags-section"],[1,"tags"],[1,"tag",3,"selected"],[1,"tag",3,"click"],[1,"btn-primary",3,"click","disabled"],[1,"btn-secondary",3,"click","disabled"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1),q(2,"div",2),a(),r(3,"h2",3),d(4),a(),r(5,"p",4),d(6),a(),f(7,K,8,2,"div",5),f(8,X,8,2,"div",5),f(9,te,14,0,"div",5),r(10,"div",6),k(11,ne,2,1,"button",7)(12,ie,2,2,"button",7),f(13,oe,2,1,"button",8),a()()),e&2&&(o(2),I("width",i.step()/(i.totalSteps-1)*100,"%"),o(2),h(i.stepTitles[i.step()]),o(2),h(i.stepSubtitles[i.step()]),o(),C(i.step()===0?7:-1),o(),C(i.step()===1?8:-1),o(),C(i.step()===2?9:-1),o(2),c("ngIf",i.step()<i.totalSteps-1),o(),c("ngIf",i.step()===i.totalSteps-1),o(),C(i.step()>0?13:-1))},dependencies:[N,A,W,R,B,D,z,F],styles:[".onboarding-container[_ngcontent-%COMP%]{max-width:620px;margin:3rem auto;text-align:center}.progress-wrapper[_ngcontent-%COMP%]{width:100%;height:6px;background:#e5e7eb;border-radius:10px;margin-bottom:2rem;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{height:6px;background:linear-gradient(135deg,#667eea,#764ba2);transition:width .4s ease}.title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.3rem}.subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:1.8rem}.card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{background:#fff;padding:1.8rem;border-radius:14px;box-shadow:0 4px 14px #0000000f;text-align:left}label[_ngcontent-%COMP%]{font-weight:600;color:#374151;margin-bottom:.7rem;display:block}select[_ngcontent-%COMP%]{width:100%;padding:.85rem;border-radius:10px;border:1px solid #d1d5db;font-size:1rem}.tags-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:1.2rem 0 .5rem;font-size:1rem;font-weight:700}.tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.tag[_ngcontent-%COMP%]{padding:8px 16px;border-radius:18px;border:2px solid #cbd5e1;background:#fff;cursor:pointer;font-size:.85rem;transition:.25s}.tag.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#34d399);border-color:transparent;color:#fff}.summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem}.summary-item[_ngcontent-%COMP%]{margin-bottom:.8rem;font-size:1rem}.nav-buttons[_ngcontent-%COMP%]{margin-top:2rem;display:flex;flex-direction:row-reverse;justify-content:space-between}.btn-primary[_ngcontent-%COMP%]{padding:.85rem 2rem;font-size:1rem;border:none;border-radius:10px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-weight:600;cursor:pointer;transition:.2s}.btn-secondary[_ngcontent-%COMP%]{padding:.85rem 2rem;font-size:1rem;border:none;border-radius:10px;background:#e5e7eb;color:#374151;font-weight:600;cursor:pointer}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .45s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}"]})};var he=[{path:"",component:w}];export{he as ONBOARDING_ROUTES};
