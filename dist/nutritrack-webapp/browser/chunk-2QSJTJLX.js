import{a as H}from"./chunk-YUW6ET6K.js";import{a as Y}from"./chunk-SMVVNKRT.js";import{b as z,c as U,g as W,j as $,p as q,q as G,r as V,v as B}from"./chunk-2VZLF2MU.js";import{a as y}from"./chunk-6LZ2YNEV.js";import{g as R}from"./chunk-7Q5XKRGT.js";import{$ as N,Dc as O,Ec as T,Ka as l,Kb as A,Mb as r,Nb as u,Ob as v,Pa as _,Qb as C,R as E,Rb as x,Sb as M,Ub as k,V as w,Va as I,Vb as D,aa as L,ib as c,jb as p,ka as g,lb as P,mb as S,nb as b,ob as a,pb as n,ub as j,wb as f,xc as F,yb as m}from"./chunk-FVUT7SF7.js";import"./chunk-2VMXMS7J.js";var h=class i{constructor(t){this.http=t}planesUrl=`${y.apiUrl}/planes`;rutinasUrl=`${y.apiUrl}/rutinas`;verCatalogo(t=!1,e=0,o=20){let d=new O().set("sugeridos",t.toString()).set("page",e.toString()).set("size",o.toString());return this.http.get(`${this.planesUrl}/catalogo`,{params:d})}verDetallePlan(t){return this.http.get(`${this.planesUrl}/catalogo/${t}`)}verCatalogoRutinas(t=!1,e=0,o=20){let d=new O().set("sugeridos",t.toString()).set("page",e.toString()).set("size",o.toString());return this.http.get(`${this.rutinasUrl}/catalogo`,{params:d})}verDetalleRutina(t){return this.http.get(`${this.rutinasUrl}/catalogo/${t}`)}static \u0275fac=function(e){return new(e||i)(w(T))};static \u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"})};var Z=()=>["/metas/mis-asignaciones"],ee=i=>["/metas/planes",i],K=(i,t)=>t.id;function te(i,t){i&1&&(a(0,"div",18)(1,"p"),r(2,"Cargando planes..."),n()())}function ne(i,t){i&1&&(a(0,"p",21),r(1,"Intenta desactivar el filtro de planes sugeridos"),n())}function ie(i,t){if(i&1&&(a(0,"div",19)(1,"p"),r(2,"No se encontraron planes disponibles con los filtros seleccionados"),n(),c(3,ne,2,0,"p",21),n()),i&2){let e=m();l(3),p(e.soloSugeridos?3:-1)}}function ae(i,t){i&1&&(a(0,"span",25),r(1,"\u2728 Sugerido"),n())}function oe(i,t){if(i&1&&(a(0,"div",28)(1,"span",29),r(2,"Objetivo:"),n(),a(3,"span",30),r(4),n()(),a(5,"div",28)(6,"span",29),r(7,"Calor\xEDas:"),n(),a(8,"span",30),r(9),n()()),i&2){let e=m().$implicit,o=m(2);l(4),u(o.formatearObjetivo(e.objetivo.tipoObjetivo)),l(5),v("",e.objetivo.caloriasObjetivo," kcal")}}function re(i,t){i&1&&(a(0,"div",28)(1,"span",29),r(2,"Objetivo:"),n(),a(3,"span",35),r(4,"No especificado"),n()())}function le(i,t){if(i&1&&(a(0,"span",36),r(1),n()),i&2){let e=t.$implicit;l(),u(e.nombre)}}function se(i,t){if(i&1&&(a(0,"div",31),P(1,le,2,1,"span",36,K),n()),i&2){let e=m().$implicit;l(),S(e.etiquetas)}}function de(i,t){if(i&1){let e=j();a(0,"div",23)(1,"div",24)(2,"h3"),r(3),n(),c(4,ae,2,0,"span",25),n(),a(5,"p",26),r(6),n(),a(7,"div",27)(8,"div",28)(9,"span",29),r(10,"Duraci\xF3n:"),n(),a(11,"span",30),r(12),n()(),c(13,oe,10,2)(14,re,5,0,"div",28),n(),c(15,se,3,0,"div",31),a(16,"div",32)(17,"button",33),r(18," Ver Detalles "),n(),a(19,"button",34),f("click",function(){let d=N(e).$implicit,s=m(2);return L(s.activarPlan(d))}),r(20),n()()()}if(i&2){let e=t.$implicit,o=m(2);A("plan-sugerido",e.sugerido),l(3),u(e.nombre),l(),p(e.sugerido?4:-1),l(2),u(e.descripcion),l(6),v("",e.duracionDias," d\xEDas"),l(),p(e.objetivo?13:14),l(2),p(e.etiquetas&&e.etiquetas.length>0?15:-1),l(2),b("routerLink",D(11,ee,e.id)),l(2),b("disabled",o.activandoPlan()===e.id),l(),v(" ",o.activandoPlan()===e.id?"Activando...":"Activar Plan"," ")}}function ce(i,t){if(i&1&&(a(0,"div",20),P(1,de,21,13,"div",22,K),n()),i&2){let e=m();l(),S(e.planesFiltrados())}}var J=class i{constructor(t,e,o){this.catalogoService=t;this.metasService=e;this.notificationService=o}loading=g(!1);activandoPlan=g(null);filtroNombre="";filtroObjetivo="";soloSugeridos=!1;planes=g([]);planesFiltrados=g([]);ngOnInit(){this.cargarPlanes()}cargarPlanes(){this.loading.set(!0),this.catalogoService.verCatalogo(this.soloSugeridos).subscribe({next:t=>{if(this.loading.set(!1),t.success){let e=t.data?.content||t.data||[];this.planes.set(e),this.filtrarPlanes()}},error:t=>{this.loading.set(!1),this.notificationService.showError(t.error?.message||"Error al cargar el cat\xE1logo de planes")}})}filtrarPlanes(){let t=this.planes();if(this.filtroNombre){let e=this.filtroNombre.toLowerCase();t=t.filter(o=>o.nombre.toLowerCase().includes(e)||o.descripcion.toLowerCase().includes(e))}this.filtroObjetivo&&(t=t.filter(e=>e.objetivo?.tipoObjetivo===this.filtroObjetivo)),this.planesFiltrados.set(t)}activarPlan(t){this.activandoPlan.set(t.id),this.metasService.activarPlan({planId:t.id}).subscribe({next:e=>{this.activandoPlan.set(null),e.success&&this.notificationService.showSuccess(`Plan "${t.nombre}" activado exitosamente`)},error:e=>{this.activandoPlan.set(null),this.notificationService.showError(e.error?.message||"Error al activar el plan")}})}formatearObjetivo(t){return{PERDIDA_PESO:"P\xE9rdida de Peso",GANANCIA_MUSCULAR:"Ganancia Muscular",MANTENIMIENTO:"Mantenimiento",DEFINICION:"Definici\xF3n",SALUD_GENERAL:"Salud General"}[t]||t}static \u0275fac=function(e){return new(e||i)(_(h),_(H),_(Y))};static \u0275cmp=I({type:i,selectors:[["app-catalogo-lista-planes"]],decls:33,vars:8,consts:[[1,"catalogo-planes-container"],[1,"header"],[1,"btn-back",3,"routerLink"],[1,"subtitle"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Buscar por nombre...",3,"ngModelChange","ngModel"],[1,"filter-objetivo"],[3,"ngModelChange","ngModel"],["value",""],["value","PERDIDA_PESO"],["value","GANANCIA_MUSCULAR"],["value","MANTENIMIENTO"],["value","DEFINICION"],["value","SALUD_GENERAL"],[1,"filter-sugeridos"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"loading"],[1,"empty-state"],[1,"planes-grid"],[1,"hint"],[1,"plan-card",3,"plan-sugerido"],[1,"plan-card"],[1,"plan-header"],[1,"badge-sugerido"],[1,"plan-description"],[1,"plan-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"plan-etiquetas"],[1,"plan-actions"],[1,"btn-primary",3,"routerLink"],[1,"btn-activate",3,"click","disabled"],[1,"stat-value","text-muted"],[1,"etiqueta"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),r(3," \u2190 Volver a Mis Asignaciones "),n(),a(4,"h1"),r(5,"Cat\xE1logo de Planes Nutricionales"),n(),a(6,"p",3),r(7,"Explora planes disponibles seg\xFAn tu perfil y objetivos"),n()(),a(8,"div",4)(9,"div",5)(10,"input",6),M("ngModelChange",function(s){return x(o.filtroNombre,s)||(o.filtroNombre=s),s}),f("ngModelChange",function(){return o.filtrarPlanes()}),n()(),a(11,"div",7)(12,"select",8),M("ngModelChange",function(s){return x(o.filtroObjetivo,s)||(o.filtroObjetivo=s),s}),f("ngModelChange",function(){return o.filtrarPlanes()}),a(13,"option",9),r(14,"Todos los objetivos"),n(),a(15,"option",10),r(16,"P\xE9rdida de Peso"),n(),a(17,"option",11),r(18,"Ganancia Muscular"),n(),a(19,"option",12),r(20,"Mantenimiento"),n(),a(21,"option",13),r(22,"Definici\xF3n"),n(),a(23,"option",14),r(24,"Salud General"),n()()(),a(25,"div",15)(26,"label",16)(27,"input",17),M("ngModelChange",function(s){return x(o.soloSugeridos,s)||(o.soloSugeridos=s),s}),f("ngModelChange",function(){return o.cargarPlanes()}),n(),a(28,"span"),r(29,"Solo planes sugeridos para mi objetivo"),n()()()(),c(30,te,3,0,"div",18),c(31,ie,4,1,"div",19),c(32,ce,3,0,"div",20),n()),e&2&&(l(2),b("routerLink",k(7,Z)),l(8),C("ngModel",o.filtroNombre),l(2),C("ngModel",o.filtroObjetivo),l(15),C("ngModel",o.soloSugeridos),l(3),p(o.loading()?30:-1),l(),p(!o.loading()&&o.planesFiltrados().length===0?31:-1),l(),p(!o.loading()&&o.planesFiltrados().length>0?32:-1))},dependencies:[F,R,B,G,V,U,z,q,W,$],styles:[".catalogo-planes-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center;position:relative}.btn-back[_ngcontent-%COMP%]{position:absolute;left:0;top:0;padding:.625rem 1.25rem;background:#edf2f7;color:#4a5568;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:.875rem;transition:all .2s}.btn-back[_ngcontent-%COMP%]:hover{background:#e2e8f0;transform:translate(-2px)}h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#2d3748;margin:0 0 .5rem}.subtitle[_ngcontent-%COMP%]{color:#718096;font-size:1.125rem;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;align-items:center;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{flex:1;min-width:250px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem}.filter-objetivo[_ngcontent-%COMP%]{min-width:200px}.filter-objetivo[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem;background-color:#fff}.filter-sugeridos[_ngcontent-%COMP%]{display:flex;align-items:center}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.95rem;color:#4a5568}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.planes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.plan-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;transition:transform .2s,box-shadow .2s;display:flex;flex-direction:column;border:2px solid transparent}.plan-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.plan-card.plan-sugerido[_ngcontent-%COMP%]{border-color:#f6ad55;background:linear-gradient(to bottom,#fffaf0,#fff)}.plan-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;gap:1rem}.plan-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#2d3748;flex:1}.badge-sugerido[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:600;background:linear-gradient(135deg,#f6ad55,#ed8936);color:#fff;white-space:nowrap}.plan-description[_ngcontent-%COMP%]{color:#718096;margin-bottom:1rem;line-height:1.5}.plan-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1rem;padding:1rem;background:#f7fafc;border-radius:8px}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#718096;margin-bottom:.25rem}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#2d3748}.stat-value.text-muted[_ngcontent-%COMP%]{color:#a0aec0;font-style:italic}.plan-etiquetas[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.etiqueta[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#edf2f7;color:#4a5568;border-radius:20px;font-size:.875rem}.plan-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:auto}.btn-primary[_ngcontent-%COMP%], .btn-activate[_ngcontent-%COMP%]{padding:.625rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:.875rem;flex:1;min-width:120px}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-activate[_ngcontent-%COMP%]{background:#48bb78;color:#fff}.btn-activate[_ngcontent-%COMP%]:hover:not(:disabled){background:#38a169;transform:translateY(-2px);box-shadow:0 4px 12px #48bb7866}.btn-activate[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#718096}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.125rem}.empty-state[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-size:.95rem;color:#a0aec0;margin-top:.5rem}"]})};export{J as MetasListaPlanesComponent};
