import{a as Y}from"./chunk-65QLZD5N.js";import{a as B}from"./chunk-SLRXGNQN.js";import{b as I,c as L,g as F,j as A,p as T,q as z,r as j,w as V}from"./chunk-M75YHKAC.js";import{a as q}from"./chunk-GZZKD4TH.js";import{a as W}from"./chunk-F5B3K5RO.js";import"./chunk-6ULEJF3H.js";import{d as D}from"./chunk-LBN5CU62.js";import"./chunk-NZVHEJ25.js";import{Bb as w,Db as f,Fb as c,Kc as N,Na as s,Sb as R,Ta as p,Tb as r,Ub as _,Vb as b,Xb as C,Yb as M,Zb as x,_a as y,ac as E,bc as k,ca as O,da as S,na as u,nb as g,ob as m,rb as h,sb as P,tb as v,ub as a,vb as i}from"./chunk-N5FZ7NRP.js";import"./chunk-2VMXMS7J.js";var G=()=>["/metas/mis-asignaciones"],H=o=>["/metas/rutinas",o],$=(o,t)=>t.id;function J(o,t){o&1&&(a(0,"div",15)(1,"p"),r(2,"Cargando rutinas..."),i()())}function K(o,t){o&1&&(a(0,"div",16)(1,"p"),r(2,"No se encontraron rutinas con los filtros seleccionados"),i()())}function Q(o,t){o&1&&(a(0,"span",22),r(1,"Disponible"),i())}function U(o,t){o&1&&(a(0,"span",23),r(1,"No Disponible"),i())}function X(o,t){if(o&1&&(a(0,"span",32),r(1),i()),o&2){let e=t.$implicit;s(),_(e.nombre)}}function tt(o,t){if(o&1&&(a(0,"div",29),h(1,X,2,1,"span",32,$),i()),o&2){let e=c().$implicit;s(),P(e.etiquetas)}}function et(o,t){if(o&1){let e=w();a(0,"button",33),f("click",function(){O(e);let d=c().$implicit,l=c(2);return S(l.activarRutina(d))}),r(1),i(),a(2,"button",34),r(3," \u{1F441}\uFE0F Ver Detalle "),i()}if(o&2){let e=c().$implicit,n=c(2);v("disabled",n.activandoRutina()===e.id),s(),b(" ",n.activandoRutina()===e.id?"Activando...":"\u{1F680} Activar Rutina"," "),s(),v("routerLink",k(3,H,e.id))}}function nt(o,t){o&1&&(a(0,"button",31),r(1," No Disponible "),i())}function it(o,t){if(o&1&&(a(0,"div",18)(1,"div",19)(2,"h3"),r(3),i(),a(4,"div",20)(5,"span",21),r(6),i(),g(7,Q,2,0,"span",22)(8,U,2,0,"span",23),i()(),a(9,"p",24),r(10),i(),a(11,"div",25)(12,"div",26)(13,"span",27),r(14,"Duraci\xF3n:"),i(),a(15,"span",28),r(16),i()(),a(17,"div",26)(18,"span",27),r(19,"Ejercicios:"),i(),a(20,"span",28),r(21),i()(),a(22,"div",26)(23,"span",27),r(24,"Patr\xF3n:"),i(),a(25,"span",28),r(26),i()()(),g(27,tt,3,0,"div",29),a(28,"div",30),g(29,et,4,5)(30,nt,2,0,"button",31),i()()),o&2){let e=t.$implicit,n=c(2);s(3),_(e.nombre),s(2),R("nivel-"+e.nivelDificultad.toLowerCase()),s(),b(" ",n.formatearNivel(e.nivelDificultad)," "),s(),m(e.activo?7:8),s(3),_(e.descripcion),s(6),b("",e.duracionSemanas," semanas"),s(5),_(e.totalEjerciciosProgramados||0),s(5),b("",e.patronSemanas," semana(s)"),s(),m(e.etiquetas&&e.etiquetas.length>0?27:-1),s(2),m(e.activo?29:30)}}function at(o,t){if(o&1&&(a(0,"div",17),h(1,it,31,11,"div",18,$),i()),o&2){let e=c();s(),P(e.rutinasFiltradas())}}var Z=class o{constructor(t,e,n,d){this.catalogoService=t;this.metasService=e;this.notificationService=n;this.mockData=d}loading=u(!1);activandoRutina=u(null);filtroNombre="";filtroNivel="";soloSugeridos=!1;rutinas=u([]);rutinasFiltradas=u([]);rutinasActivasIds=u(new Set);ngOnInit(){this.cargarRutinasActivas(),this.cargarRutinas()}cargarRutinasActivas(){this.metasService.obtenerRutinasActivas().subscribe({next:t=>{if(t.success&&t.data){let e=new Set(t.data.map(n=>n.rutinaId));this.rutinasActivasIds.set(e),this.filtrarRutinas()}},error:t=>{console.warn("No se pudieron cargar rutinas activas:",t)}})}cargarRutinas(){this.loading.set(!0),this.catalogoService.verCatalogoRutinas(this.soloSugeridos,0,100).subscribe({next:t=>{if(this.loading.set(!1),t.success&&t.data){let e=t.data.content||t.data||[];e.length>0?(this.rutinas.set(e),this.filtrarRutinas()):(this.rutinas.set(this.mockData.rutinasDisponibles()),this.filtrarRutinas(),this.notificationService.showInfo("No hay rutinas en el cat\xE1logo. Mostrando ejemplos."))}else this.rutinas.set(this.mockData.rutinasDisponibles()),this.filtrarRutinas()},error:t=>{this.loading.set(!1),console.error("Error cargando cat\xE1logo de rutinas:",t),this.rutinas.set(this.mockData.rutinasDisponibles()),this.filtrarRutinas(),this.notificationService.showWarning("Sin conexi\xF3n al servidor. Mostrando datos de ejemplo.")}})}filtrarRutinas(){let t=this.rutinas(),e=this.rutinasActivasIds();if(t=t.filter(n=>!e.has(n.id)),this.filtroNombre){let n=this.filtroNombre.toLowerCase();t=t.filter(d=>d.nombre.toLowerCase().includes(n)||d.descripcion.toLowerCase().includes(n))}this.filtroNivel&&(t=t.filter(n=>n.nivelDificultad===this.filtroNivel)),this.rutinasFiltradas.set(t)}activarRutina(t){this.activandoRutina.set(t.id),this.metasService.activarRutina({rutinaId:t.id}).subscribe({next:e=>{this.activandoRutina.set(null),e.success?(this.notificationService.showSuccess(`Rutina "${t.nombre}" activada exitosamente`),this.cargarRutinasActivas()):this.notificationService.showError(e.message||"Error al activar la rutina")},error:e=>{this.activandoRutina.set(null);let n=e?.message||"Error al activar la rutina";this.notificationService.showError(n)}})}formatearNivel(t){return{PRINCIPIANTE:"Principiante",INTERMEDIO:"Intermedio",AVANZADO:"Avanzado"}[t]||t}static \u0275fac=function(e){return new(e||o)(p(Y),p(q),p(W),p(B))};static \u0275cmp=y({type:o,selectors:[["app-catalogo-lista-rutinas"]],decls:28,vars:8,consts:[[1,"catalogo-rutinas-container"],[1,"header"],[1,"btn-back",3,"routerLink"],[1,"subtitle"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Buscar por nombre...",3,"ngModelChange","ngModel"],[1,"filter-nivel"],[3,"ngModelChange","ngModel"],["value",""],["value","PRINCIPIANTE"],["value","INTERMEDIO"],["value","AVANZADO"],[1,"filter-sugeridos"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"loading"],[1,"empty-state"],[1,"rutinas-grid"],[1,"rutina-card"],[1,"rutina-header"],[1,"badges"],[1,"badge-nivel"],[1,"estado-badge","estado-disponible"],[1,"estado-badge","estado-inactivo"],[1,"rutina-description"],[1,"rutina-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"rutina-tags"],[1,"rutina-actions"],["disabled","",1,"btn-disabled"],[1,"tag"],[1,"btn-activate",3,"click","disabled"],[1,"btn-primary",3,"routerLink"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),r(3," \u2190 Volver a Mis Asignaciones "),i(),a(4,"h1"),r(5,"\u{1F3CB}\uFE0F\u200D\u2642\uFE0F Cat\xE1logo de Rutinas de Ejercicio"),i(),a(6,"p",3),r(7,"Explora y activa rutinas personalizadas seg\xFAn tu objetivo y nivel"),i()(),a(8,"div",4)(9,"div",5)(10,"input",6),x("ngModelChange",function(l){return M(n.filtroNombre,l)||(n.filtroNombre=l),l}),f("ngModelChange",function(){return n.filtrarRutinas()}),i()(),a(11,"div",7)(12,"select",8),x("ngModelChange",function(l){return M(n.filtroNivel,l)||(n.filtroNivel=l),l}),f("ngModelChange",function(){return n.filtrarRutinas()}),a(13,"option",9),r(14,"Todos los niveles"),i(),a(15,"option",10),r(16,"Principiante"),i(),a(17,"option",11),r(18,"Intermedio"),i(),a(19,"option",12),r(20,"Avanzado"),i()()(),a(21,"div",13)(22,"label")(23,"input",14),x("ngModelChange",function(l){return M(n.soloSugeridos,l)||(n.soloSugeridos=l),l}),f("ngModelChange",function(){return n.cargarRutinas()}),i(),r(24," Solo rutinas sugeridas para mi objetivo "),i()()(),g(25,J,3,0,"div",15),g(26,K,3,0,"div",16),g(27,at,3,0,"div",17),i()),e&2&&(s(2),v("routerLink",E(7,G)),s(8),C("ngModel",n.filtroNombre),s(2),C("ngModel",n.filtroNivel),s(11),C("ngModel",n.soloSugeridos),s(2),m(n.loading()?25:-1),s(),m(!n.loading()&&n.rutinasFiltradas().length===0?26:-1),s(),m(!n.loading()&&n.rutinasFiltradas().length>0?27:-1))},dependencies:[N,D,V,z,j,L,I,T,F,A],styles:[".catalogo-rutinas-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center;position:relative}.btn-back[_ngcontent-%COMP%]{position:absolute;left:0;top:0;padding:.625rem 1.25rem;background:#edf2f7;color:#4a5568;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:.875rem;transition:all .2s}.btn-back[_ngcontent-%COMP%]:hover{background:#e2e8f0;transform:translate(-2px)}h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#2d3748;margin:0 0 .5rem}.subtitle[_ngcontent-%COMP%]{color:#718096;font-size:1.125rem;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;align-items:center;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{flex:1;min-width:250px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem}.filter-nivel[_ngcontent-%COMP%], .filter-estado[_ngcontent-%COMP%]{min-width:200px}.filter-nivel[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-estado[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:8px;font-size:1rem;background-color:#fff}.rutinas-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.rutina-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;transition:transform .2s,box-shadow .2s;display:flex;flex-direction:column}.rutina-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.rutina-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;gap:1rem}.rutina-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#2d3748;flex:1}.badges[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:flex-end}.badge-nivel[_ngcontent-%COMP%], .estado-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:600;white-space:nowrap}.badge-nivel.nivel-principiante[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.badge-nivel.nivel-intermedio[_ngcontent-%COMP%]{background:#bee3f8;color:#2c5282}.badge-nivel.nivel-avanzado[_ngcontent-%COMP%]{background:#fbd38d;color:#7c2d12}.estado-badge.estado-activo[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.estado-badge.estado-pausado[_ngcontent-%COMP%]{background:#bee3f8;color:#2c5282}.estado-badge.estado-completado[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.estado-badge.estado-cancelado[_ngcontent-%COMP%]{background:#fed7d7;color:#742a2a}.estado-badge.estado-disponible[_ngcontent-%COMP%]{background:#48bb78;color:#fff}.rutina-description[_ngcontent-%COMP%]{color:#718096;margin-bottom:1rem;line-height:1.5}.rutina-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1rem;padding:1rem;background:#f7fafc;border-radius:8px}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;color:#718096;margin-bottom:.25rem}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#2d3748}.progress-section[_ngcontent-%COMP%]{margin-bottom:1rem}.progress-text[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;font-size:.875rem;color:#718096}.percentage[_ngcontent-%COMP%]{font-weight:600;color:#2d3748}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e2e8f0;border-radius:10px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#48bb78,#38a169);transition:width .3s ease}.rutina-etiquetas[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.etiqueta[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#edf2f7;color:#4a5568;border-radius:20px;font-size:.875rem}.rutina-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:auto}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-danger[_ngcontent-%COMP%], .btn-activate[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:.75rem;flex:1;min-width:90px}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-activate[_ngcontent-%COMP%]{background:#48bb78;color:#fff}.btn-activate[_ngcontent-%COMP%]:hover{background:#38a169}.btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-danger[_ngcontent-%COMP%]{background:#fed7d7;color:#742a2a}.btn-danger[_ngcontent-%COMP%]:hover{background:#fc8181}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#718096}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.125rem}.rutina-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:1rem}.tag[_ngcontent-%COMP%]{padding:.25rem .75rem;background:#e6f7ff;color:#06c;border-radius:12px;font-size:.875rem;font-weight:500}.btn-disabled[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#cbd5e0;color:#718096;border:none;border-radius:8px;cursor:not-allowed}.estado-inactivo[_ngcontent-%COMP%]{background:#fed7d7;color:#c53030}.filter-sugeridos[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 1rem;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.filter-sugeridos[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.95rem;color:#4a5568}.filter-sugeridos[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}"]})};export{Z as MetasListaRutinasComponent};
